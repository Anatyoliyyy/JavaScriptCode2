VERSION 5.00
Object = "{5DC35748-D70A-417E-93B7-A488F085B02F}#90.0#0"; "SMARTNETBUTTON.OCX"
Begin VB.Form Form1 
   BackColor       =   &H0000C000&
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Пятнашки"
   ClientHeight    =   4200
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   5550
   Icon            =   "Form1.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   ScaleHeight     =   4200
   ScaleWidth      =   5550
   StartUpPosition =   2  'CenterScreen
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   2
      Left            =   1080
      TabIndex        =   23
      TabStop         =   0   'False
      Top             =   120
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   3
      Left            =   2040
      TabIndex        =   24
      TabStop         =   0   'False
      Top             =   120
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   4
      Left            =   3000
      TabIndex        =   25
      TabStop         =   0   'False
      Top             =   120
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   5
      Left            =   120
      TabIndex        =   26
      TabStop         =   0   'False
      Top             =   1080
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   6
      Left            =   1080
      TabIndex        =   27
      TabStop         =   0   'False
      Top             =   1080
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   7
      Left            =   2040
      TabIndex        =   28
      TabStop         =   0   'False
      Top             =   1080
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   8
      Left            =   3000
      TabIndex        =   29
      TabStop         =   0   'False
      Top             =   1080
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   9
      Left            =   120
      TabIndex        =   30
      TabStop         =   0   'False
      Top             =   2040
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   10
      Left            =   1080
      TabIndex        =   31
      TabStop         =   0   'False
      Top             =   2040
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   11
      Left            =   2040
      TabIndex        =   32
      TabStop         =   0   'False
      Top             =   2040
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   12
      Left            =   3000
      TabIndex        =   33
      TabStop         =   0   'False
      Top             =   2040
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   13
      Left            =   120
      TabIndex        =   34
      TabStop         =   0   'False
      Top             =   3000
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   14
      Left            =   1080
      TabIndex        =   35
      TabStop         =   0   'False
      Top             =   3000
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   15
      Left            =   2040
      TabIndex        =   36
      TabStop         =   0   'False
      Top             =   3000
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      CaptionAreaLayout=   0
   End
   Begin SmartNetButtonProject.SmartNetButton knop 
      Height          =   945
      Index           =   1
      Left            =   120
      TabIndex        =   22
      TabStop         =   0   'False
      Top             =   120
      Width           =   945
      _ExtentX        =   1667
      _ExtentY        =   1667
      BackColor       =   12632256
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.CommandButton Command1 
      Caption         =   "&Результаты"
      Height          =   435
      Left            =   4305
      TabIndex        =   20
      Top             =   630
      Width           =   1170
   End
   Begin VB.TextBox tt 
      Height          =   285
      Left            =   5565
      TabIndex        =   18
      Text            =   "Text1"
      Top             =   6825
      Width           =   645
   End
   Begin VB.Timer Timer1 
      Enabled         =   0   'False
      Interval        =   1000
      Left            =   4305
      Top             =   2940
   End
   Begin VB.CommandButton Command2 
      Caption         =   "&Выход"
      Height          =   435
      Left            =   4305
      TabIndex        =   17
      Top             =   1155
      Width           =   1170
   End
   Begin VB.CommandButton new1 
      Caption         =   "&Новая Игра"
      Height          =   435
      Left            =   4305
      TabIndex        =   0
      Top             =   105
      Width           =   1170
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   0
      Left            =   105
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   1
      Top             =   105
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   1
      Left            =   1050
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   2
      Top             =   105
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   2
      Left            =   1995
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   3
      Top             =   105
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   3
      Left            =   2940
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   4
      Top             =   105
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   4
      Left            =   105
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   5
      Top             =   1050
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   5
      Left            =   1050
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   6
      Top             =   1050
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   6
      Left            =   1995
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   7
      Top             =   1050
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   7
      Left            =   2940
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   8
      Top             =   1050
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   8
      Left            =   105
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   9
      Top             =   1995
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   9
      Left            =   1050
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   10
      Top             =   1995
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   10
      Left            =   1995
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   11
      Top             =   1995
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   11
      Left            =   2940
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   12
      Top             =   1995
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   12
      Left            =   105
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   13
      Top             =   2940
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   13
      Left            =   1050
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   14
      Top             =   2940
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   950
      Index           =   14
      Left            =   1995
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   15
      Top             =   2940
      Visible         =   0   'False
      Width           =   950
   End
   Begin VB.PictureBox knop1 
      Height          =   945
      Index           =   15
      Left            =   2940
      ScaleHeight     =   885
      ScaleWidth      =   885
      TabIndex        =   16
      Top             =   2940
      Visible         =   0   'False
      Width           =   945
   End
   Begin VB.Label tim 
      AutoSize        =   -1  'True
      BackColor       =   &H0000C000&
      Caption         =   "0"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   700
         Underline       =   0   'False
         Italic          =   -1  'True
         Strikethrough   =   0   'False
      EndProperty
      Height          =   195
      Left            =   840
      TabIndex        =   21
      Top             =   3990
      Width           =   210
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   14
      Left            =   1995
      Top             =   2940
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   13
      Left            =   1050
      Top             =   2940
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   12
      Left            =   105
      Top             =   2940
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   11
      Left            =   2940
      Top             =   1995
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   10
      Left            =   1995
      Top             =   1995
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   9
      Left            =   1050
      Top             =   1995
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   8
      Left            =   105
      Top             =   1995
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   7
      Left            =   2940
      Top             =   1050
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   6
      Left            =   1995
      Top             =   1050
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   5
      Left            =   1050
      Top             =   1050
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   4
      Left            =   105
      Top             =   1050
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   3
      Left            =   2940
      Top             =   105
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   2
      Left            =   1995
      Top             =   105
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   1
      Left            =   1050
      Top             =   105
      Width           =   960
   End
   Begin VB.Image knop2 
      Height          =   960
      Index           =   0
      Left            =   105
      Top             =   105
      Width           =   960
   End
   Begin VB.Shape Shape1 
      Height          =   3795
      Left            =   105
      Top             =   105
      Width           =   3795
   End
   Begin VB.Label Label2 
      AutoSize        =   -1  'True
      BackColor       =   &H0000C000&
      Caption         =   "Время:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   204
         Weight          =   700
         Underline       =   0   'False
         Italic          =   -1  'True
         Strikethrough   =   0   'False
      EndProperty
      Height          =   195
      Left            =   105
      TabIndex        =   19
      Top             =   3990
      Width           =   735
   End
   Begin VB.Line Line1 
      BorderColor     =   &H80000005&
      Index           =   1
      X1              =   4095
      X2              =   4095
      Y1              =   105
      Y2              =   3990
   End
   Begin VB.Line Line1 
      BorderWidth     =   2
      Index           =   0
      X1              =   4095
      X2              =   4095
      Y1              =   105
      Y2              =   3990
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Dim kk As Integer
Dim Top2(1 To 15) As Integer
Dim Left2(1 To 15) As Integer
Dim itim As Integer
Dim j, Ochki As Integer

Private Sub Command1_Click()
Dialog.Command3.Enabled = False
Dialog.comm.Text = "scores"
Dialog.Show vbModal
End Sub

Private Sub Command2_Click()
End
End Sub

Private Sub Form_Load()
Dim i As Integer
For i = 1 To 15
Left2(i) = knop(i).Left
Top2(i) = knop(i).Top
knop2(i - 1).Tag = i
Next i
Dim j As Integer
For j = 1 To 15
    knop(j).Enabled = False
Next j
End Sub

Private Sub new1_Click()
Dim j As Integer
itim = 0
For j = 1 To 15
    knop(j).Enabled = True
Next j
NewGame
Timer1.Enabled = True
tt.SetFocus
End Sub

Private Sub knop_Click(Index As Integer)
On Error Resume Next
Dim i, i1, Top1, Left1, Index1 As Integer
Top1 = knop(Index).Top
Left1 = knop(Index).Left
kk = Index
tt.SetFocus
If (Top1 = 105 And Left1 = 105) Then
    Index1 = 0
        If knop1(4).Tag <> "1" Then
        knop(Index).Top = knop1(4).Top
        knop(Index).Left = knop1(4).Left
        knop1(4).Tag = "1"
        knop1(0).Tag = ""
    ElseIf knop1(1).Tag <> "1" Then
        knop(Index).Top = knop1(1).Top
        knop(Index).Left = knop1(1).Left
        knop1(1).Tag = "1"
        knop1(0).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 105 And Left1 = 1050) Then
    Index1 = 1
        If knop1(0).Tag <> "1" Then
        knop(Index).Top = knop1(0).Top
        knop(Index).Left = knop1(0).Left
        knop1(0).Tag = "1"
        knop1(1).Tag = ""
    ElseIf knop1(2).Tag <> "1" Then
        knop(Index).Top = knop1(2).Top
        knop(Index).Left = knop1(2).Left
        knop1(2).Tag = "1"
        knop1(1).Tag = ""
    ElseIf knop1(5).Tag <> "1" Then
        knop(Index).Top = knop1(5).Top
        knop(Index).Left = knop1(5).Left
        knop1(5).Tag = "1"
        knop1(1).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 105 And Left1 = 1995) Then
    Index1 = 2
    If knop1(3).Tag <> "1" Then
        knop(Index).Top = knop1(3).Top
        knop(Index).Left = knop1(3).Left
        knop1(3).Tag = "1"
        knop1(2).Tag = ""
    ElseIf knop1(1).Tag <> "1" Then
        knop(Index).Top = knop1(1).Top
        knop(Index).Left = knop1(1).Left
        knop1(1).Tag = "1"
        knop1(2).Tag = ""
    ElseIf knop1(6).Tag <> "1" Then
        knop(Index).Top = knop1(6).Top
        knop(Index).Left = knop1(6).Left
        knop1(6).Tag = "1"
        knop1(2).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 105 And Left1 = 2940) Then
    Index1 = 3
        If knop1(2).Tag <> "1" Then
        knop(Index).Top = knop1(2).Top
        knop(Index).Left = knop1(2).Left
        knop1(2).Tag = "1"
        knop1(3).Tag = ""
    ElseIf knop1(7).Tag <> "1" Then
        knop(Index).Top = knop1(7).Top
        knop(Index).Left = knop1(7).Left
        knop1(7).Tag = "1"
        knop1(3).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 1050 And Left1 = 105) Then
    Index1 = 4
        If knop1(0).Tag <> "1" Then
        knop(Index).Top = knop1(0).Top
        knop(Index).Left = knop1(0).Left
        knop1(0).Tag = "1"
        knop1(4).Tag = ""
    ElseIf knop1(5).Tag <> "1" Then
        knop(Index).Top = knop1(5).Top
        knop(Index).Left = knop1(5).Left
        knop1(5).Tag = "1"
        knop1(4).Tag = ""
    ElseIf knop1(8).Tag <> "1" Then
        knop(Index).Top = knop1(8).Top
        knop(Index).Left = knop1(8).Left
        knop1(8).Tag = "1"
        knop1(4).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 1050 And Left1 = 1050) Then
    Index1 = 5
    If knop1(4).Tag <> "1" Then
        knop(Index).Top = knop1(4).Top
        knop(Index).Left = knop1(4).Left
        knop1(4).Tag = "1"
        knop1(5).Tag = ""
    ElseIf knop1(1).Tag <> "1" Then
        knop(Index).Top = knop1(1).Top
        knop(Index).Left = knop1(1).Left
        knop1(1).Tag = "1"
        knop1(5).Tag = ""
    ElseIf knop1(9).Tag <> "1" Then
        knop(Index).Top = knop1(9).Top
        knop(Index).Left = knop1(9).Left
        knop1(9).Tag = "1"
        knop1(5).Tag = ""
    ElseIf knop1(6).Tag <> "1" Then
        knop(Index).Top = knop1(6).Top
        knop(Index).Left = knop1(6).Left
        knop1(6).Tag = "1"
        knop1(5).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 1050 And Left1 = 1995) Then
    Index1 = 6
    If knop1(7).Tag <> "1" Then
        knop(Index).Top = knop1(7).Top
        knop(Index).Left = knop1(7).Left
        knop1(7).Tag = "1"
        knop1(6).Tag = ""
    ElseIf knop1(5).Tag <> "1" Then
        knop(Index).Top = knop1(5).Top
        knop(Index).Left = knop1(5).Left
        knop1(5).Tag = "1"
        knop1(6).Tag = ""
    ElseIf knop1(2).Tag <> "1" Then
        knop(Index).Top = knop1(2).Top
        knop(Index).Left = knop1(2).Left
        knop1(2).Tag = "1"
        knop1(6).Tag = ""
    ElseIf knop1(10).Tag <> "1" Then
        knop(Index).Top = knop1(10).Top
        knop(Index).Left = knop1(10).Left
        knop1(10).Tag = "1"
        knop1(6).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 1050 And Left1 = 2940) Then
    Index1 = 7
    If knop1(3).Tag <> "1" Then
        knop(Index).Top = knop1(3).Top
        knop(Index).Left = knop1(3).Left
        knop1(3).Tag = "1"
        knop1(7).Tag = ""
    ElseIf knop1(11).Tag <> "1" Then
        knop(Index).Top = knop1(11).Top
        knop(Index).Left = knop1(11).Left
        knop1(11).Tag = "1"
        knop1(7).Tag = ""
    ElseIf knop1(6).Tag <> "1" Then
        knop(Index).Top = knop1(6).Top
        knop(Index).Left = knop1(6).Left
        knop1(6).Tag = "1"
        knop1(7).Tag = ""
    End If
    
    '***********************************************
ElseIf (Top1 = 1995 And Left1 = 105) Then
    Index1 = 8
    If knop1(4).Tag <> "1" Then
        knop(Index).Top = knop1(4).Top
        knop(Index).Left = knop1(4).Left
        knop1(4).Tag = "1"
        knop1(8).Tag = ""
    ElseIf knop1(12).Tag <> "1" Then
        knop(Index).Top = knop1(12).Top
        knop(Index).Left = knop1(12).Left
        knop1(12).Tag = "1"
        knop1(8).Tag = ""
    ElseIf knop1(9).Tag <> "1" Then
        knop(Index).Top = knop1(9).Top
        knop(Index).Left = knop1(9).Left
        knop1(9).Tag = "1"
        knop1(8).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 1995 And Left1 = 1050) Then
    Index1 = 9
    If knop1(8).Tag <> "1" Then
        knop(Index).Top = knop1(8).Top
        knop(Index).Left = knop1(8).Left
        knop1(8).Tag = "1"
        knop1(9).Tag = ""
    ElseIf knop1(10).Tag <> "1" Then
        knop(Index).Top = knop1(10).Top
        knop(Index).Left = knop1(10).Left
        knop1(10).Tag = "1"
        knop1(9).Tag = ""
    ElseIf knop1(13).Tag <> "1" Then
        knop(Index).Top = knop1(13).Top
        knop(Index).Left = knop1(13).Left
        knop1(13).Tag = "1"
        knop1(9).Tag = ""
    ElseIf knop1(5).Tag <> "1" Then
        knop(Index).Top = knop1(5).Top
        knop(Index).Left = knop1(5).Left
        knop1(5).Tag = "1"
        knop1(9).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 1995 And Left1 = 1995) Then
    Index1 = 10
    If knop1(11).Tag <> "1" Then
        knop(Index).Top = knop1(11).Top
        knop(Index).Left = knop1(11).Left
        knop1(11).Tag = "1"
        knop1(10).Tag = ""
    ElseIf knop1(9).Tag <> "1" Then
        knop(Index).Top = knop1(9).Top
        knop(Index).Left = knop1(9).Left
        knop1(9).Tag = "1"
        knop1(10).Tag = ""
    ElseIf knop1(14).Tag <> "1" Then
        knop(Index).Top = knop1(14).Top
        knop(Index).Left = knop1(14).Left
        knop1(14).Tag = "1"
        knop1(10).Tag = ""
    ElseIf knop1(6).Tag <> "1" Then
        knop(Index).Top = knop1(6).Top
        knop(Index).Left = knop1(6).Left
        knop1(6).Tag = "1"
        knop1(10).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 1995 And Left1 = 2940) Then
    Index1 = 11
    If knop1(15).Tag <> "1" Then
        knop(Index).Top = knop1(15).Top
        knop(Index).Left = knop1(15).Left
        knop1(15).Tag = "1"
        knop1(11).Tag = ""
    ElseIf knop1(10).Tag <> "1" Then
        knop(Index).Top = knop1(10).Top
        knop(Index).Left = knop1(10).Left
        knop1(10).Tag = "1"
        knop1(11).Tag = ""
    ElseIf knop1(7).Tag <> "1" Then
        knop(Index).Top = knop1(7).Top
        knop(Index).Left = knop1(7).Left
        knop1(7).Tag = "1"
        knop1(11).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 2940 And Left1 = 105) Then
    Index1 = 12
    If knop1(13).Tag <> "1" Then
        knop(Index).Top = knop1(13).Top
        knop(Index).Left = knop1(13).Left
        knop1(13).Tag = "1"
        knop1(12).Tag = ""
    ElseIf knop1(8).Tag <> "1" Then
        knop(Index).Top = knop1(8).Top
        knop(Index).Left = knop1(8).Left
        knop1(8).Tag = "1"
        knop1(12).Tag = ""
    ElseIf knop1(12).Tag <> "1" Then
        knop(Index).Top = knop1(12).Top
        knop(Index).Left = knop1(12).Left
        knop1(12).Tag = "1"
        knop1(12).Tag = ""
    End If
    
    '***********************************************
ElseIf (Top1 = 2940 And Left1 = 1050) Then
    Index1 = 13
    If knop1(12).Tag <> "1" Then
        knop(Index).Top = knop1(12).Top
        knop(Index).Left = knop1(12).Left
        knop1(12).Tag = "1"
        knop1(13).Tag = ""
    ElseIf knop1(14).Tag <> "1" Then
        knop(Index).Top = knop1(14).Top
        knop(Index).Left = knop1(14).Left
        knop1(14).Tag = "1"
        knop1(13).Tag = ""
    ElseIf knop1(9).Tag <> "1" Then
        knop(Index).Top = knop1(9).Top
        knop(Index).Left = knop1(9).Left
        knop1(9).Tag = "1"
        knop1(13).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 2940 And Left1 = 1995) Then
    Index1 = 14
    If knop1(13).Tag <> "1" Then
        knop(Index).Top = knop1(13).Top
        knop(Index).Left = knop1(13).Left
        knop1(13).Tag = "1"
        knop1(14).Tag = ""
    ElseIf knop1(15).Tag <> "1" Then
        knop(Index).Top = knop1(15).Top
        knop(Index).Left = knop1(15).Left
        knop1(15).Tag = "1"
        knop1(14).Tag = ""
    ElseIf knop1(10).Tag <> "1" Then
        knop(Index).Top = knop1(10).Top
        knop(Index).Left = knop1(10).Left
        knop1(10).Tag = "1"
        knop1(14).Tag = ""
    End If
    '***********************************************
ElseIf (Top1 = 2940 And Left1 = 2940) Then
    Index1 = 15
    If knop1(14).Tag <> "1" Then
        knop(Index).Top = knop1(14).Top
        knop(Index).Left = knop1(14).Left
        knop1(14).Tag = "1"
        knop1(15).Tag = ""
    ElseIf knop1(11).Tag <> "1" Then
        knop(Index).Top = knop1(11).Top
        knop(Index).Left = knop1(11).Left
        knop1(11).Tag = "1"
        knop1(15).Tag = ""
    End If
    End If
    
    If (knop(1).Top = knop2(0).Top And knop(1).Left = knop2(0).Left) Then
        If (knop(2).Top = knop2(1).Top And knop(2).Left = knop2(1).Left) Then
            If (knop(3).Top = knop2(2).Top And knop(3).Left = knop2(2).Left) Then
                If (knop(4).Top = knop2(3).Top And knop(4).Left = knop2(3).Left) Then
                    If (knop(5).Top = knop2(4).Top And knop(5).Left = knop2(4).Left) Then
                        If (knop(6).Top = knop2(5).Top And knop(6).Left = knop2(5).Left) Then
                            If (knop(7).Top = knop2(6).Top And knop(7).Left = knop2(6).Left) Then
                                If (knop(8).Top = knop2(7).Top And knop(8).Left = knop2(7).Left) Then
                                    If (knop(9).Top = knop2(8).Top And knop(9).Left = knop2(8).Left) Then
                                        If (knop(10).Top = knop2(9).Top And knop(10).Left = knop2(9).Left) Then
                                            If (knop(11).Top = knop2(10).Top And knop(11).Left = knop2(10).Left) Then
                                                If (knop(12).Top = knop2(11).Top And knop(12).Left = knop2(11).Left) Then
                                                    If (knop(13).Top = knop2(12).Top And knop(13).Left = knop2(12).Left) Then
                                                        If (knop(14).Top = knop2(13).Top And knop(14).Left = knop2(13).Left) Then
                                                            If (knop(15).Top = knop2(14).Top And knop(15).Left = knop2(14).Left) Then
                                                                Win
                                                            End If
                                                        End If
                                                    End If
                                                End If
                                            End If
                                        End If
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End If
    End If
End Sub

Private Sub NewGame()
Static m(0 To 15) As Boolean
Dim MestoKnopki As Integer
Dim i, i1, Top1, Left1, Index1 As Integer
Randomize
For i1 = 0 To 15
m(i1) = False
knop1(i1).Tag = ""
Next i1
For i = 1 To 15
m(MestoKnopki) = True
Do While m(MestoKnopki) = True
MestoKnopki = Int(15 * Rnd + 1)
Loop
m(MestoKnopki) = True
Select Case MestoKnopki
    Case 1
        Top1 = 105
        Left1 = 105
        Index1 = 0
    Case 2
        Top1 = 105
        Left1 = 1050
        Index1 = 1
    Case 3
        Top1 = 105
        Left1 = 1995
        Index1 = 2
    Case 4
        Top1 = 105
        Left1 = 2940
        Index1 = 3
    Case 5
        Top1 = 1050
        Left1 = 105
        Index1 = 4
    Case 6
        Top1 = 1050
        Left1 = 1050
        Index1 = 5
    Case 7
        Top1 = 1050
        Left1 = 1995
        Index1 = 6
    Case 8
        Top1 = 1050
        Left1 = 2940
        Index1 = 7
    Case 9
        Top1 = 1995
        Left1 = 105
        Index1 = 8
    Case 10
        Top1 = 1995
        Left1 = 1050
        Index1 = 9
    Case 11
        Top1 = 1995
        Left1 = 1995
        Index1 = 10
    Case 12
        Top1 = 1995
        Left1 = 2940
        Index1 = 11
    Case 13
        Top1 = 2940
        Left1 = 105
        Index1 = 12
    Case 14
        Top1 = 2940
        Left1 = 1050
        Index1 = 13
    Case 15
        Top1 = 2940
        Left1 = 1995
        Index1 = 14
    End Select
knop(i).Top = Top1
knop(i).Left = Left1
knop1(Index1).Tag = 1
Next i
End Sub

Private Sub Timer1_Timer()
itim = itim + 1
tim.Caption = itim
End Sub

Private Sub Win()
Timer1.Enabled = False
Ochki = 10000 / itim
Dialog.comm.Text = "add"
Dialog.txtscore.Text = Str(Ochki)
Dialog.Picture2.ZOrder
Dialog.Show
For j = 1 To 15
    knop(j).Enabled = False
Next j
itim = 0
End Sub
